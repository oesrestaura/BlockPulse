Refactor role management for server (high-priority)
